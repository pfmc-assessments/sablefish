```{r executive, echo = FALSE}
executive <- list()
executive[["stock"]] <- paste0("This assessment update reports the status of ",
  spp, " (_", spp.sci, "_) off the ", coast, 
  " using data through 2022.")
```


# Executive summary{-}

## Stock{-}

`r executive[["stock"]]` The resource is modeled as a single stock; however, sablefish disperse to and from offshore seamounts, along the coastal waters of the U.S. West Coast, Canada, and Alaska, and across the Aleutian Islands to the western Pacific. This potential movement is not explicitly accounted for in this analysis.

## Landings and catches{-}

The earliest landings of `r spp` off the West Coast used within in this assessment begin in `r startyr`. The landings begun to slowly increase starting in the 1920s and continued at a roughly constant level until the 1970s where landings sharply increased peaking in the late 1970s (Figure \@ref(fig:es-landings)). After peaking in the late 1970s, catches slowly decreased across the time series until the 2000s when catches generally stabilized. Fishery landings have been divided among two coastwide fleets: a fixed gear and a trawl fleet (see Table \@ref(tab:es-landings) for the most recent ten years). The assessment update estimates annual discard mortality by fleet informed by data from the \glsentrylong{wcgop} and other historical discarding studies. This internal estimation can result in model estimates of catches (landings plus discards) that differ between stock assessments, even when the input landings remain unchanged, due to changes in fixed and estimated parameter values, priors, or parameterizations. 

The landings in this assessment update were minimally revised and corrected from those used 2019 benchmark and the 2021 update assessments. First, landings from the `Oregon Coast' \glsentrylong{inpfc} area, i.e., between 42.000--46.267\textdegree N. latitude, are no longer excluded from the total landings. Second, landings from 1977--1982 in the catch reporting area that includes both U.S. and Canadian waters are now assigned 50--50\% to each country rather than 100\% to the U.S. Third, a time series of `r spp` catches from the At-Sea Pacific Hake fishery are now included in the trawl fleet. Previous assessments have included bycatch of `r spp` from the shoreside fleet but these at-sea catches were previously only included as a sensitivity. 

```{r, results = "asis"}

tab <- model$timeseries[model$timeseries$Yr %in% (endyr-9):endyr, 
                        c("Yr", "retain(B):_1", "retain(B):_2", "dead(B):_1", "dead(B):_2")]
df <- data.frame(
  Year = tab[,"Yr"],
  Fixed_Gear = tab[,"retain(B):_1"],
  Trawl = tab[, "retain(B):_2"],
  Landings = tab[, "retain(B):_1"] + tab[, "retain(B):_2"],
  Catch = tab[, "dead(B):_1"] + tab[, "dead(B):_2"]
)
sa4ss::table_format(
  x = df,
  caption = "Landings (mt) by fleet and the summed coastwide total landings and estimated total catch.",
  label = "es-landings",
  digits = 1,
  align = "l",
  # to do: use a renamer between fleet number and name
  col_names = c("Year", "Fixed Gear Landings", "Trawl Landings", "Total Landings", "Total Catch")
)
```


```{r, results = "asis"}
sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "catch2 landings stacked.png"
  ),
  caption = "Landings by year from the fixed gear (FIX) and trawl (TWL) fleets.",
  alt_caption = "",
  label = "es-landings"
)
```


## Data and assessment{-}

This assessment uses the stock assessment framework \gls{ss3} version `r ss3_version[["current"]]`.

Replace text with
date of last assessment,
type of assessment model,
data available,
new information, and
information lacking.

## Stock biomass and dynamics{-}

Replace text with
trends and current levels relative to virgin or historic levels and
description of uncertainty.
Include Table for last 10 years.
Include Figure with long-term estimates.


```{r, results = "asis"}
sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "ts7_Spawning_biomass_(mt)_with_95_asymptotic_intervals_intervals.png"
  ),
  caption = "Estimated time series of spawning output (circles and line: median; light broken lines: 95 percent intervals) for the base model",
  alt_caption = "",
  label = "es-sb"
)

sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "ts9_Relative_spawning_biomass_intervals.png"
  ),
  caption = "Estimated time series of fraction of unfished spawning output (circles and line: median; light broken lines: 95 percent intervals) for the base model",
  alt_caption = "",
  label = "es-depl"
)
```


## Recruitment{-}

Replace text with
trends and current levels relative to virgin or historic levels and
description of uncertainty.
Include Table for last 10 years.
Include Figure with long-term estimates.


```{r, results = "asis"}
sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "ts11_Age-0_recruits_(1000s)_with_95_asymptotic_intervals.png"
  ),
  caption = "Estimated time series of age-0 recruits (1000s) for the base model with 95 percent intervals.",
  alt_caption = "",
  label = "es-recruits"
)

sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "recdevs2_withbars.png"
  ),
  caption = "Estimated time series of recruitment deviations.",
  alt_caption = "",
  label = "es-rec-devs"
)
```




## Exploitation status{-}

Replace text with
total catch divided by exploitable biomass or SPR harvest rate.
Include Table for last 10 years.
Include Figure with trend in f relative to target vs. trend in biomass relative to the target.


```{r, results = "asis"}
sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "SPR3_ratiointerval.png"
  ),
  caption = "Time series of SPR ratio: (1-SPR)/(1-SPR 45%).",
  alt_caption = "",
  label = "es-1-spr"
)

```



## Ecosystem considerations{-}

Replace text with
a summary of reviewed environmental and ecosystem factors that appear to be correlated with stock dynamics.
These may include variability in they physical environment, habitat, competitors, prey, or predators that directly or indirectly affects the stock's status, vital rates (growth, survival, productivity/recruitment) or range and distribution.
Note which, if any, ecosystem factors are used in the assessment and how (e.g., as background information, in data preparations, as data inputs, in decisions about model structure).

## Reference points{-}

Replace text with
management targets and definition of overfishing, including the harvest rate that brings the stock to equilibrium at $B_{40\%}$, i.e., the $B_{MSY}$ proxy and the equilibrium stock size that results from fishing at the default harvest rate, i.e., the $F_{MSY}$ proxy.
Include Table of estimated reference points for ssb, SPR, exploitation rate, and yield based on SSB proxy for MSY, SPR proxy for MSY, and estimated MSY values.


```{r, results = "asis"}
sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "SPR4_phase.png"
  ),
  caption = "Phase plot of biomass ratio vs. SPR ratio.
Each point represents the biomass ratio at the start of the year and the relative fishing intensity in that same year. Warmer colors (red) represent early years and colder colors (blue) represent recent years. Lines through the final point show 95% intervals based on the asymptotic uncertainty for each dimension.",
  alt_caption = "",
  label = "es-phase"
)

sa4ss::add_figure(
  filein = fs::path(
    model_location,
    "plots",
    "yield2_yield_curve_with_refpoints.png"
  ),
  caption = "Yield curve with reference points.",
  alt_caption = "",
  label = "es-yield"
)
```

## Management performance{-}

Include Table of most recent 10 years of
catches in comparison with OFL, ABC, HG, and OY/ACL values,
overfishing levels,
actual catch and discard.
Include OFL (encountered), OFL (retained), and OFL (dead) if different due to discard and discard mortality.

## Unresolved problems and major uncertainties{-}

```{r, echo=FALSE, results="asis"}
filein = fs::path(here::here("assessment", "shared_text","unresolved_uncertanties.Rmd"))
sa4ss::read_child(filein)
```


## Decision table and projections{-}

Replace text with
projected yields (OFL, ABC, and ACL), spawning biomass, and stock depletion levels for each year.
OFL calculations should be based on the assumption that future catches equal ABCs and not OFLs.

## Scientific uncertainty{-}

```{r, echo=FALSE, results="asis"}
filein = fs::path(here::here("assessment", "shared_text","scientific_uncertainty.Rmd"))
sa4ss::read_child(filein)
```


## Research and data needs{-}

Please refer to the 2019 benchmark assessment for a detailed list of research and data needs for `r spp` [@haltuch_status_2019b].

