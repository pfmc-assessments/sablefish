---
month: "`r format(Sys.Date(), '%B')`"
year: "`r format(Sys.Date(), '%Y')`"
preamble: |
csl: canadian-journal-of-fisheries-and-aquatic-sciences.csl
disclaimer: true
output:
  sa4ss::techreport_pdf:
    default
  bookdown::pdf_document2:
    keep_tex: true
papersize: letter
---

```{r opts, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
knitr::knit_hooks$set(plot = function(x,options) {
      base = knitr::opts_knit$get('base.url')
      if (is.null(base)) base = ''
      alt = ifelse (is.null(options$alt),"",options$alt)
      cap = ifelse (is.null(options$caption),"",options$caption)
      if (alt != ""){
        sprintf('![%s](%s%s "%s")', cap, base, x, alt)
      } else {
        sprintf('![%s](%s%s)', cap, base, x)
        }
  })

load("00opts.Rdata")
```

```{r inputs-load-model, cache = TRUE, include = FALSE}
# User-specific settings
model_location <- fs::path(
  here::here(),
 "models", "2023", "FixRetSel", "base"
)
model_location_previous <- fs::path(
  here::here(),
 "models", "2021", "base", "base"
)

# Functionality from sa4ss::read_model
model <- r4ss::SS_output(
  dir = model_location,
  printstats = FALSE,
  verbose = FALSE
)
model_previous <- r4ss::SS_output(
  dir = model_location_previous,
  printstats = FALSE,
  verbose = FALSE,
  wtfile = NULL
)
ss3_version <- strsplit(
  purrr::map_chr(
    list("current" = model, "previous" = model_previous),
    "SS_version"
  ),
  split = ";"
) |>
  purrr::map(1)
r4ss::SS_plots(
  replist = model,
  dir = model_location,
  # to do
  # fleetnames = c(),
  verbose = FALSE
)
```

```{r env-model-objects}
startyr <- model$startyr
endyr <- model$endyr
last10 <- endyr - 8
currentyr <- endyr + 1
project_start <- min(model$timeseries$Yr[model$timeseries$Era == "FORE"])
project_end <- max(model$timeseries$Yr[model$timeseries$Era == "FORE"])
```
